<div class="col-12 p-5">
  <div class="stories-card card">
    <div class="card-body">
      <h2 class="card-title">Historias de tus amigos</h2>
      <div class="dropdown-divider"></div>
      <div class="row mt-4">
        <div class="col-2 my-story-card p-3">
          <div class="flex align-items-center">
            <p>Hola {{ userLogged.name }}, esta es tu historia</p>
            <div class="d-flex justify-content-start align-self-end">
              <p-button
                label="Agregar"
                icon="pi pi-plus"
                iconPos="left"
                styleClass="p-button-sm"
                class="w-100"
                (click)="showModalDialogAddStory()"
              ></p-button>
              <button
                pButton
                pRipple
                type="button"
                label="Mi historia"
                class="p-button-outlined p-button-secondary w-100 p-button-sm"
                *ngIf="userStories.length > 0"
                (click)="showModalDialog()"
              ></button>
            </div>
            <div class="dropdown-divider"></div>
            <small class="mt-2">
              Has ingresado como: {{ userLogged.email }}
            </small>
          </div>
        </div>

        <div *ngFor="let user of users" class="col-2">
          <app-story [storiesData]="dataStories[user]"></app-story>
        </div>

        <p-dialog
          header="Agrega una historia"
          [(visible)]="displayModalAddStory"
          [modal]="true"
          [style]="{ width: '30vw' }"
          [draggable]="false"
          [resizable]="false"
        >
          <div class="card">
            <div class="p-grid p-fluid">
              <div class="p-field p-col-12">
                <label for="description">Descripcion de tu historia</label>
                <br />
                <input
                  id="description"
                  type="text"
                  aria-describedby="description"
                  pInputText
                  [(ngModel)]="description"
                />
                <br />
                <small id="username1-help"
                  >Breve descripcion de lo que vas a publicar</small
                >
              </div>
              <br />
              <div class="p-field p-col-6">
                <label for="reference">Referencia del recurso</label>
                <br />
                <input
                  id="reference"
                  type="text"
                  aria-describedby="reference"
                  pInputText
                  [(ngModel)]="reference"
                />
                <br />
                <small id="username1-help">Por ahora solo imagenes :) </small>
              </div>
              <br />
              <div class="p-field p-col-6">
                <label for="referenceType">Tipo de referencia</label>
                <br />
                <input
                  id="referenceType"
                  type="text"
                  aria-describedby="referenceType"
                  pInputText
                  [(ngModel)]="referenceType"
                />
                <br />
                <small id="username1-help">jpg o jpeg</small>
              </div>
            </div>
          </div>

          <ng-template pTemplate="footer">
            <p-button
              icon="pi pi-send"
              (click)="sendStory()"
              label="Enviar"
              styleClass="p-button-text"
            ></p-button>
          </ng-template>
        </p-dialog>

        <p-dialog
          header="Tus historias"
          [(visible)]="displayModal"
          [modal]="true"
          [style]="{ width: '30vw' }"
          [draggable]="false"
          [resizable]="false"
        >
          <div class="card">
            <ul class="list-style-none">
              <li
                class="d-flex no-block card-body"
                *ngFor="let story of userStories"
              >
                <p-image
                  src="{{ story.reference }}"
                  alt="Image"
                  width="100"
                  height="100"
                  class="p-2"
                ></p-image>
                <!-- <i class="mdi mdi-check-circle fs-4 w-30px mt-1"></i> -->
                <div class="align-self-center">
                  <p class="mb-0 font-medium p-0">Tu historia</p>
                  <span class="text-muted"
                    >Publicada el {{ getFormattedDate(story.created_at) }}</span
                  >
                </div>
                <div class="ms-auto align-self-center">
                  <div class="tetx-right">
                    <button
                      pButton
                      pRipple
                      type="button"
                      icon="pi pi-times"
                      class="p-button-rounded p-button-danger p-button-outlined"
                      (click)="deleteStory(story.temporal_post_id)"
                    ></button>
                  </div>
                </div>
              </li>
            </ul>
          </div>

          <ng-template pTemplate="footer">
            <p-button
              icon="pi pi-check"
              (click)="displayModal = false"
              label="Cerrar"
              styleClass="p-button-text"
            ></p-button>
          </ng-template>
        </p-dialog>
      </div>
    </div>
  </div>
</div>
